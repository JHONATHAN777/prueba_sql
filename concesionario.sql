CREATE TABLE CLIENTE (
    CLIENTE_ID INT NOT NULL PRIMARY KEY,
    CEDULA INT,
    NOMBRE VARCHAR(255),
    TELEFONO1 INT,
    TELEFONO2 INT
);

CREATE TABLE CARRO (
    CARRO_ID INT NOT NULL PRIMARY KEY,
    PLACA VARCHAR(255),
    MARCA VARCHAR(255),
    MODELO VARCHAR(255),
    COSTO FLOAT,
    DISPONIBLE INT
);

CREATE TABLE ALQUILER (
    ALQUILER_ID INT NOT NULL PRIMARY KEY,
    CLIENTE_ID INT NOT NULL,
    CARRO_ID INT NOT NULL,
    FECHA DATE,
    TIEMPO INT,
    SALDO FLOAT,
    ABONO_INICIAL FLOAT,
    DEVUELTO INT,
    FOREIGN KEY (CLIENTE_ID) REFERENCES CLIENTE(CLIENTE_ID),
    FOREIGN KEY (CARRO_ID) REFERENCES CARRO(CARRO_ID)
);

CREATE TABLE PAGOS (
    PAGOS_ID INT NOT NULL PRIMARY KEY,
    ALQUILER_ID INT NOT NULL,
    FECHA DATE,
    VALOR FLOAT,
    FOREIGN KEY (ALQUILER_ID) REFERENCES ALQUILER(ALQUILER_ID)
);

INSERT INTO
    CLIENTE (CLIENTE_ID, CEDULA, NOMBRE, TELEFONO1, TELEFONO2)
VALUES
    (1, 1026584007, 'CAMILO', 32045785, 314729800),
    (2, 1026584008, 'JUAN', 37895785, 352790788),
    (3, 1026584004, 'IVAN', 3787775, 352790788),
    (4, 1026584009, 'DIANA', 37555585, 352790788);

INSERT INTO
    CARRO (
        CARRO_ID,
        PLACA,
        MARCA,
        MODELO,
        COSTO,
        DISPONIBLE
    )
VALUES
    (1, 'P-2133', 'TOYOTA', 'X300', 2022, 1),
    (2, 'P-1313', 'SANDERO', 'Z400', 2023, 1),
    (3, 'P-6767', 'KIA', 'Z89', 1935, 1935),
    (4, 'P-5786', 'CHEVROLET', 'N5468', 1970, 1);

INSERT INTO
    ALQUILER (
        ALQUILER_ID,
        CLIENTE_ID,
        CARRO_ID,
        FECHA,
        TIEMPO,
        SALDO,
        ABONO_INICIAL,
        DEVUELTO
    )
VALUES
    (1, 1, 1, '12-01-1980', 7, 10, 10, 0),
    (2, 1, 2, '12-01-2022', 5, 5, 15, 0),
    (4, 1, 2, '12-01-2022', 5, 5, 15, 0),
    (3, 2, 3, '12-01-1980', 12, 5, 15, 0);

INSERT INTO
    PAGOS (PAGOS_ID, ALQUILER_ID, FECHA, VALOR)
VALUES
    (1, 1, '12-01-1980', 20),
    (2, 2, '12-01-1980', 20),
    (3, 3, '12-01-1980', 20);

SELECT
    COUNT(*) AS NUMERO_DE_ALQUILERES
FROM
    ALQUILER
    INNER JOIN CARRO ON ALQUILER.CARRO_ID = CARRO.CARRO_ID
WHERE
    ALQUILER.FECHA = '12-01-1980'
    AND CARRO.MARCA = 'TOYOTA';

SELECT
    SUM(ALQUILER.SALDO) AS GANANCIA_DEL_DIA
FROM
    ALQUILER
WHERE
    ALQUILER.FECHA = '12-01-1980';

SELECT
    CLIENTE.CEDULA,
    CLIENTE.NOMBRE,
    ALQUILER.FECHA,
    ALQUILER.TIEMPO,
    ALQUILER.SALDO,
    CARRO.PLACA,
    CARRO.MARCA
FROM
    CLIENTE
    INNER JOIN ALQUILER ON ALQUILER.CLIENTE_ID = CLIENTE.CLIENTE_ID
    INNER JOIN CARRO ON ALQUILER.CARRO_ID = CARRO.CARRO_ID
SELECT
    COUNT(*) AS CLIENTES_QUE_NO_ALQULARON_SUMATORIA
FROM
    ALQUILER
WHERE
    ALQUILER.FECHA NOT BETWEEN '12-01-2023'
    AND '12-09-2023';

SELECT
    CLIENTE.NOMBRE AS CLIENTES_QUE_NO_ALQUILARON
FROM
    CLIENTE
    INNER JOIN ALQUILER ON ALQUILER.CLIENTE_ID = CLIENTE.CLIENTE_ID
WHERE
    ALQUILER.FECHA NOT BETWEEN '12-01-2023'
    AND '12-09-2023';

SELECT
    c.PLACA,
    c.MODELO,
    c.MARCA,
    c.COSTO,
    COUNT(a.CARRO_ID) AS CUANTOS_ALQUILERES,
    SUM(a.CARRO_ID) AS TOTAL_ALQUILERES
FROM
    CARRO c
    INNER JOIN ALQUILER a ON a.CARRO_ID = c.CARRO_ID
GROUP BY
    c.PLACA,
    c.MODELO,
    c.MARCA,
    c.COSTO;

SELECT
    TOP 1 ALQUILER.FECHA AS PRIMER_ALQUILER
FROM
    CLIENTE
    INNER JOIN ALQUILER ON ALQUILER.CLIENTE_ID = CLIENTE.CLIENTE_ID
ORDER BY
    ALQUILER.FECHA;